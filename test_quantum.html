<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Example: quantum circuits – fasttransform</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-000f0825b9c55ed21d14970d810c14a9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Example: quantum circuits – fasttransform">
<meta property="og:description" content="Transform is the main building block of data pipelines in fastai. And elsewhere if you want.">
<meta property="og:site_name" content="fasttransform">
<meta name="twitter:title" content="Example: quantum circuits – fasttransform">
<meta name="twitter:description" content="Transform is the main building block of data pipelines in fastai. And elsewhere if you want.">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">fasttransform</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./test_quantum.html">Example: quantum circuits</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome to fasttransform</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cast.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cast</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transform</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fastcore_migration_guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fastcore migration guide</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test_quantum.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Example: quantum circuits</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#transform" id="toc-transform" class="nav-link active" data-scroll-target="#transform">Transform</a></li>
  <li><a href="#pipeline" id="toc-pipeline" class="nav-link" data-scroll-target="#pipeline">Pipeline</a></li>
  <li><a href="#quantum" id="toc-quantum" class="nav-link" data-scroll-target="#quantum">Quantum</a>
  <ul class="collapse">
  <li><a href="#single-qubit" id="toc-single-qubit" class="nav-link" data-scroll-target="#single-qubit">Single Qubit</a></li>
  <li><a href="#multi-qubit" id="toc-multi-qubit" class="nav-link" data-scroll-target="#multi-qubit">Multi Qubit</a></li>
  </ul></li>
  <li><a href="#closing" id="toc-closing" class="nav-link" data-scroll-target="#closing">Closing</a></li>
  <li><a href="#learning-resources" id="toc-learning-resources" class="nav-link" data-scroll-target="#learning-resources">Learning resources</a>
  <ul class="collapse">
  <li><a href="#online-resources" id="toc-online-resources" class="nav-link" data-scroll-target="#online-resources">Online Resources</a></li>
  <li><a href="#books" id="toc-books" class="nav-link" data-scroll-target="#books">Books</a></li>
  <li><a href="#youtube" id="toc-youtube" class="nav-link" data-scroll-target="#youtube">YouTube</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/AnswerDotAI/fasttransform/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="test_quantum.md"><i class="bi bi-file-code"></i>CommonMark</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Example: quantum circuits</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<p><em>This example is adapted from a blogpost by Carlo Lepelaars and originally appeared on his <a href="https://carlo.ai/posts/fastcore-quantum">personal website</a>. It is reposted here with permission.</em></p>
<div id="7858aeaf" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy.testing <span class="im">import</span> assert_almost_equal</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fasttransform <span class="im">import</span> Transform, Pipeline</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="transform" class="level2">
<h2 class="anchored" data-anchor-id="transform">Transform</h2>
<p>Transform is a fundamental building block to manipulate data in Python. While extremely simple to use, it is also flexible. Transforms can be set up to change behavior based on the input type, also called type dispatch. Transforms can also be made reversible. Keep this reversibility in mind for the quantum part later! Here is a simple example of a Transform that can square a number and take square root as reverse:</p>
<div id="12697996" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> S(Transform):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> encodes(<span class="va">self</span>, x): <span class="cf">return</span> x <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> decodes(<span class="va">self</span>, x): <span class="cf">return</span> x <span class="op">**</span> <span class="fl">0.5</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> S()(<span class="dv">10</span>) <span class="op">==</span> <span class="dv">100</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> S().decode(<span class="dv">100</span>) <span class="op">==</span> <span class="dv">10</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> S().decode(S()(<span class="dv">10</span>)) <span class="op">==</span> <span class="dv">10</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>A Transform with only <code>encode</code> can be defined even simpler with a <code>lambda</code> function. By default, <code>decode</code> returns its input (i.e.&nbsp;does nothing / “no-op”):</p>
<div id="352f8206" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>square <span class="op">=</span> Transform(<span class="kw">lambda</span> x: x <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> square(<span class="dv">10</span>) <span class="op">==</span> <span class="dv">100</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> square.decode(<span class="dv">100</span>) <span class="op">==</span> <span class="dv">100</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><a href="https://AnswerDotAI.github.io/fasttransform/transform.html#transform"><code>Transform</code></a> can also be used as a decorator to turn a function into a <a href="https://AnswerDotAI.github.io/fasttransform/transform.html#transform"><code>Transform</code></a>:</p>
<div id="9ec477e1" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="at">@Transform</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> square(x): <span class="cf">return</span> x <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>square(<span class="dv">10</span>) <span class="co"># 100</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(square) <span class="co"># &lt;class 'fastcore.transform.Transform'&gt;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>fasttransform.transform.Transform</code></pre>
</div>
</div>
<p>A powerful feature of <a href="https://AnswerDotAI.github.io/fasttransform/transform.html#transform"><code>Transform</code></a> is type dispatch:</p>
<div id="96e98014" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MultiS(Transform):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> encodes(<span class="va">self</span>, x: <span class="bu">int</span> <span class="op">|</span> <span class="bu">float</span> <span class="op">|</span> <span class="bu">complex</span> <span class="op">|</span> <span class="bu">tuple</span>): <span class="cf">return</span> x<span class="op">**</span><span class="dv">2</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> encodes(<span class="va">self</span>, x: <span class="bu">list</span>): <span class="cf">return</span> [x<span class="op">**</span><span class="dv">2</span> <span class="cf">for</span> x <span class="kw">in</span> x]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> decodes(<span class="va">self</span>, x: <span class="bu">int</span> <span class="op">|</span> <span class="bu">float</span> <span class="op">|</span> <span class="bu">complex</span> <span class="op">|</span> <span class="bu">tuple</span>): <span class="cf">return</span> x<span class="op">**</span><span class="fl">0.5</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> decodes(<span class="va">self</span>, x: <span class="bu">list</span>): <span class="cf">return</span> [x<span class="op">**</span><span class="fl">0.5</span> <span class="cf">for</span> x <span class="kw">in</span> x]</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>ms <span class="op">=</span> MultiS()</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>ms</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>MultiS(enc:2,dec:2)</code></pre>
</div>
</div>
<div id="5c756161" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lists</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># By default, Transform processes lists as a whole</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2nd encodes method is called</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> ms([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]) <span class="op">==</span> [<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">9</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="7fdac3bb" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2nd decodes method is called</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> ms.decode([<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">9</span>]) <span class="op">==</span> [<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">3.0</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="22042fef" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tuples</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># By default, Transform processes tuples elementwise</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1st decodes method is called</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> ms((<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)) <span class="op">==</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">9</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="b3a2b4cf" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1st decodes method is called</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> ms.decode((<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">9</span>)) <span class="op">==</span> (<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">3.0</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="d9785fd2" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Complex numbers</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1st encodes method is called on complex number</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> ms(<span class="ot">10.0j</span>) <span class="op">==</span> (<span class="op">-</span><span class="dv">100</span><span class="op">+</span><span class="ot">0j</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a538e706" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1st decodes method is called on complex number</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> ms.decode(ms(<span class="ot">10.0j</span>)) <span class="op">==</span> (<span class="fl">6.123233995736766e-16</span><span class="op">+</span><span class="ot">10j</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><a href="https://AnswerDotAI.github.io/fasttransform/transform.html#transform"><code>Transform</code></a> automatically routes input to the corresponding method based on the input type. <a href="https://AnswerDotAI.github.io/fasttransform/transform.html#transform"><code>Transform</code></a> will operate on lists as a whole, while tuples are processed elementwise. Processing lists and arrays as one object is a common use case in data science, for example if we are processing batches of images (3D arrays) for machine learning. If you want a <a href="https://AnswerDotAI.github.io/fasttransform/transform.html#transform"><code>Transform</code></a> that also transforms tuples as a whole, use <a href="https://AnswerDotAI.github.io/fasttransform/transform.html#itemtransform"><code>ItemTransform</code></a>. To support inplace transforms use <a href="https://AnswerDotAI.github.io/fasttransform/transform.html#inplacetransform"><code>InplaceTransform</code></a>.</p>
</section>
<section id="pipeline" class="level2">
<h2 class="anchored" data-anchor-id="pipeline">Pipeline</h2>
<p>Now that we have a firm understanding of <a href="https://AnswerDotAI.github.io/fasttransform/transform.html#transform"><code>Transform</code></a>, <a href="https://AnswerDotAI.github.io/fasttransform/transform.html#pipeline"><code>Pipeline</code></a> can be used to chain them together:</p>
<div id="99cc2c49" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> S(Transform):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Square a number. Reverse is square root."</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> encodes(<span class="va">self</span>, x): <span class="cf">return</span> x <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> decodes(<span class="va">self</span>, x): <span class="cf">return</span> x <span class="op">**</span> <span class="fl">0.5</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> A(Transform):</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Add 1. Reverse is subtract 1."</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> encodes(<span class="va">self</span>, x): <span class="cf">return</span> x <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> decodes(<span class="va">self</span>, x): <span class="cf">return</span> x <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>pipe <span class="op">=</span> Pipeline([S(), A()])</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> pipe(<span class="dv">10</span>) <span class="op">==</span> <span class="dv">101</span> <span class="co"># 10**2 + 1 = 101</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> pipe.decode(<span class="dv">10</span>) <span class="op">==</span> <span class="fl">3.0</span> <span class="co"># (10 - 1)**0.5 = 3.0</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> pipe.decode(pipe(<span class="dv">10</span>)) <span class="op">==</span> <span class="dv">10</span> <span class="co"># (10**2 + 1 - 1)**0.5 = 10</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>I hope you appreciate the simplicity of <a href="https://AnswerDotAI.github.io/fasttransform/transform.html#transform"><code>Transform</code></a> and <a href="https://AnswerDotAI.github.io/fasttransform/transform.html#pipeline"><code>Pipeline</code></a>. This year I’ve been working on an open-source library for quantum computing that connects several quantum computing frameworks and standards (For example, <a href="https://github.com/Qiskit/qiskit">Qiskit</a>, <a href="https://github.com/PennyLaneAI/pennylane">PennyLane</a> and <a href="https://en.wikipedia.org/wiki/OpenQASM">OpenQASM</a>. At the base of it lies <a href="https://github.com/numpy/numpy">numpy</a>. To generalize quantum circuits I tried using <a href="https://scikit-learn.org/stable/modules/compose.html">scikit-learn’s Pipeline</a> functionality. Unfortunately this led to a lot of boilerplate code and unnecessary features. fastcore offers a more elegant and promising solution for the use case of constructing quantum circuits, which we will explore in the next section.</p>
</section>
<section id="quantum" class="level2">
<h2 class="anchored" data-anchor-id="quantum">Quantum</h2>
<p>Quantum computing processes can be simulated on classical computers by transforming a&nbsp;<a href="https://en.wikipedia.org/wiki/Quantum_state">statevector</a>&nbsp;(i.e.&nbsp;list of&nbsp;<a href="https://en.wikipedia.org/wiki/Complex_number">complex numbers</a>) through a series of&nbsp;<a href="https://en.wikipedia.org/wiki/Quantum_logic_gate">reversible quantum logic gates</a>&nbsp;(i.e.&nbsp;matrix of complex numbers). The state and gates are subject to constraints, but the basic operation is (reversible) vector-matrix multiplication. This is a perfect use case for fastcore’s&nbsp;<a href="https://AnswerDotAI.github.io/fasttransform/transform.html#transform"><code>Transform</code></a>&nbsp;and&nbsp;<a href="https://AnswerDotAI.github.io/fasttransform/transform.html#pipeline"><code>Pipeline</code></a>. To illustrate this point we will start with manipulating a single qubit using&nbsp;<a href="https://AnswerDotAI.github.io/fasttransform/transform.html#transform"><code>Transform</code></a>.</p>
<section id="single-qubit" class="level3">
<h3 class="anchored" data-anchor-id="single-qubit">Single Qubit</h3>
<p>A statevector contains 2 complex numbers which gives us the likelihood of obtaining a <span class="math inline">\(0\)</span> or <span class="math inline">\(1\)</span>. This is called a <a href="https://en.wikipedia.org/wiki/Quantum_superposition">superposition</a> between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>. The numbers in the vector are called <a href="https://www.youtube.com/watch?v=XrKl38ZVofo">probability amplitudes</a> and can be converted to probabilities by computing <span class="math inline">\(|x|^2\)</span> (i.e.&nbsp;the absolute value squared), where <span class="math inline">\(x\)</span> is the statevector. Probabilities must always sum to <span class="math inline">\(1\)</span>, so a valid qubit state <span class="math inline">\([\alpha, \beta]\)</span> must have <span class="math inline">\(|\alpha|^2 + |\beta|^2 = 1\)</span>.</p>
<p>A shortcut used for writing quantum states is <a href="https://en.wikipedia.org/wiki/Bra%E2%80%93ket_notation">Dirac notation</a>. For example <span class="math inline">\(|0\rangle=[1, 0]^T\)</span> (i.e.&nbsp;always 0) and <span class="math inline">\(|1\rangle=[0, 1]^T\)</span> (i.e.&nbsp;always 1). Other valid single qubit states include <span class="math inline">\(\frac{1}{\sqrt{2}}(|0\rangle + |1\rangle) = \begin{bmatrix} \frac{1}{\sqrt{2}} \frac{1}{\sqrt{2}} \end{bmatrix}^T\)</span> for a perfectly equal superposition and <span class="math inline">\(\frac{1+i}{2}|0\rangle + \frac{1-i}{2}|1\rangle = \begin{bmatrix} \frac{1+i}{2} \frac{1-i}{2} \end{bmatrix}^T\)</span> for a superposition of both the real and complex parts.</p>
<p>Using <a href="https://AnswerDotAI.github.io/fasttransform/transform.html#transform"><code>Transform</code></a> we can easily define quantum logic gates. We define a base <a href="https://AnswerDotAI.github.io/fasttransform/transform.html#transform"><code>Transform</code></a> that can do vector-matrix multiplication in a reversible way and implement common quantum gates. The <a href="https://en.wikipedia.org/wiki/Quantum_logic_gate#:~:text=in%20the%20literature.-,Identity%20gate,-%5Bedit%5D">I (identity) gate</a> does nothing, the <a href="https://en.wikipedia.org/wiki/Quantum_logic_gate#:~:text=multi%2Dqubit%20circuits.-,Pauli%20gates%20(X%2CY%2CZ),-%5Bedit%5D">X (NOT) gate</a> flips the qubit from <span class="math inline">\(|0\rangle\)</span> to <span class="math inline">\(|1\rangle\)</span> and vice versa. The <a href="https://en.wikipedia.org/wiki/Quantum_logic_gate#:~:text=%5B16%5D-,Hadamard%20gate,-%5Bedit%5D">Hadamard gate</a> turns a qubit into superposition (i.e.&nbsp;turn <span class="math inline">\(|0\rangle\)</span> into <span class="math inline">\(\frac{1}{\sqrt{2}}(|0\rangle + |1\rangle)\)</span>).</p>
<div id="5f3a9c51" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> _Q(Transform):</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Base transform for quantum gates"</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> encodes(<span class="va">self</span>, x): <span class="cf">return</span> x <span class="op">@</span> <span class="va">self</span>.gate</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> decodes(<span class="va">self</span>, x): <span class="cf">return</span> x <span class="op">@</span> <span class="va">self</span>.gate.conj().T</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                     </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> I(_Q):</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Identity gate. Does nothing."</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    gate <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>], </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                     [<span class="dv">0</span>, <span class="dv">1</span>]])</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> X(_Q):</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">"X (NOT) gate. Flips from |0&gt; to |1&gt; and vice versa."</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    gate <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">1</span>], </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>                     [<span class="dv">1</span>, <span class="dv">0</span>]])</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> H(_Q):</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Hadamard (Superposition) gate. Turns a qubit into a superposition."</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    gate <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">1</span>], </span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>                     [<span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>]]) <span class="op">/</span> np.sqrt(<span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>This allows us to easily play with quantum gates:</p>
<div id="4288bbef" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>zero_state <span class="op">=</span> [<span class="dv">1</span><span class="op">+</span><span class="ot">0j</span>, <span class="dv">0</span><span class="op">+</span><span class="ot">0j</span>] <span class="co"># Basis state |0&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>superposition_state <span class="op">=</span> np.array([<span class="fl">0.5</span><span class="op">+</span><span class="ot">0.5j</span>, <span class="fl">0.5</span><span class="op">-</span><span class="ot">0.5j</span>])  <span class="co"># Complex superposition</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="16b1582c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identity operation</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> I() </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>assert_almost_equal(i(zero_state), np.array([<span class="fl">1.</span><span class="op">+</span><span class="ot">0.j</span>, <span class="fl">0.</span><span class="op">+</span><span class="ot">0.j</span>])) <span class="co"># (|0&gt;)</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>assert_almost_equal(i.decode(zero_state), np.array([<span class="fl">1.</span><span class="op">+</span><span class="ot">0.j</span>, <span class="fl">0.</span><span class="op">+</span><span class="ot">0.j</span>]))  <span class="co"># (|0&gt;)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="0f5c7726" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># X (NOT) operation </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> X()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>assert_almost_equal(x(zero_state), np.array([<span class="dv">0</span><span class="op">+</span><span class="ot">0j</span>, <span class="dv">1</span><span class="op">+</span><span class="ot">0j</span>]))  <span class="co"># (|1&gt;)</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>assert_almost_equal(x.decode(x(zero_state)), np.array([<span class="fl">1.</span><span class="op">+</span><span class="ot">0.j</span>, <span class="fl">0.</span><span class="op">+</span><span class="ot">0.j</span>]))  <span class="co"># (|0&gt;)</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>assert_almost_equal(x(superposition_state), np.array([<span class="fl">0.5</span><span class="op">-</span><span class="ot">0.5j</span>, <span class="fl">0.5</span><span class="op">+</span><span class="ot">0.5j</span>]))  <span class="co"># (flips sign of complex part)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="d20f3b21" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hadamard gate tests</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> H()</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>assert_almost_equal(h(zero_state), np.array([<span class="fl">0.707</span><span class="op">+</span><span class="ot">0.j</span>, <span class="fl">0.707</span><span class="op">+</span><span class="ot">0.j</span>]), decimal<span class="op">=</span><span class="dv">3</span>)  <span class="co"># (superposition)</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>assert_almost_equal(h(superposition_state), np.array([<span class="fl">0.707</span><span class="op">+</span><span class="ot">0.j</span>, <span class="fl">0.</span><span class="op">+</span><span class="ot">0.707j</span>]), decimal<span class="op">=</span><span class="dv">3</span>)  <span class="co"># (phase state)</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>assert_almost_equal(h.decode(h(superposition_state)), np.array([<span class="fl">0.5</span><span class="op">+</span><span class="ot">0.5j</span>, <span class="fl">0.5</span><span class="op">-</span><span class="ot">0.5j</span>]))  <span class="co"># (complex superposition)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>I hope this gives you an appreciation for the simplicity of <a href="https://AnswerDotAI.github.io/fasttransform/transform.html#transform"><code>Transform</code></a> and why it works for quantum, even if the details and meaning of these operations might not be clear yet. If you are interested in learning about quantum computing I highly recommend reading the amazing educational material on <a href="https://quantum.country">quantum.country</a>. A great quantum textbook is <a href="https://www.amazon.com/Quantum-Computation-Information-10th-Anniversary/dp/1107002176?crid=VJB5339SIYMB&amp;dib=eyJ2IjoiMSJ9.eSzRaEDPfZNRNJrJx5nhCTp0oQkLWZkujqGOiuevj_sHJbKkL1Gzm-lj8Yg2C3VA11v61b8iZ-lMx5ju_Os5gYarrMvkrmlT5axEqzNql0rF7vdjvVx1wdd4zI7PnuATJf-wu3J6ifpngHnkYPoPII5TV6ywBOK4K34NY0JAHOkhAfyndoZWV3oxb3asowdT77R7mV6CA0CQUD6Vv2zmMFjeeGxBJO4Sexl8HlJNLRQ.fjinpRoMwoKMQ9jlWLL8j1bgA5KWKM-F8lPFzA-5hvo&amp;dib_tag=se&amp;keywords=quantum+computation+and+information&amp;qid=1732985753&amp;sprefix=quantum+computation+and+information,aps,213&amp;sr=8-1&amp;linkCode=sl1&amp;tag=carloai-20&amp;linkId=0a6f532c12be8d87a7717d00f3c91991&amp;language=en_US&amp;ref_=as_li_ss_tl">“Quantum Computing and Quantum Information” by Michael Nielsen and Isaac Chuang</a>.</p>
<p>Another essential component of quantum is <a href="https://en.wikipedia.org/wiki/Measurement_in_quantum_mechanics">measurement</a>. This transforms the quantum state into a probability distribution we can sample from. Note that these operations are not reversible. This is because after measurement, a quantum state <a href="https://en.wikipedia.org/wiki/Wave_function_collapse">collapses</a>:</p>
<div id="b46975e5" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> M(Transform):</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Turn a quantum statevector into a probability distribution"</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> encodes(<span class="va">self</span>, x): <span class="cf">return</span> np.<span class="bu">abs</span>(x)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> decodes(<span class="va">self</span>, x): <span class="cf">return</span> <span class="pp">NotImplementedError</span>(<span class="st">"No inverse exists for absolute value."</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Samp(Transform):</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Sample from a probability distribution"</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> encodes(<span class="va">self</span>, x): <span class="cf">return</span> <span class="bu">format</span>(np.random.choice(<span class="bu">len</span>(x), p<span class="op">=</span>x), <span class="ss">f'0</span><span class="sc">{</span><span class="bu">int</span>(np.log2(<span class="bu">len</span>(x)))<span class="sc">}</span><span class="ss">b'</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> decodes(<span class="va">self</span>, x): <span class="cf">return</span> <span class="pp">NotImplementedError</span>(<span class="st">"Sampling is not reversible."</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> M()</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>samp <span class="op">=</span> Samp()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="2f27b1f1" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sampling from zero state (|0&gt;)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>zero_state <span class="op">=</span> [<span class="dv">1</span><span class="op">+</span><span class="ot">0j</span>, <span class="dv">0</span><span class="op">+</span><span class="ot">0j</span>]</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>mzs <span class="op">=</span> m(zero_state) <span class="co"># Transforms [1+0j, 0+0j] -&gt; [1, 0]</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>assert_almost_equal(mzs, np.array([<span class="dv">1</span><span class="op">+</span><span class="ot">0j</span>,<span class="dv">0</span><span class="op">+</span><span class="ot">0j</span>]))                     </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> samp(mzs) <span class="op">==</span> <span class="st">'0'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="27ad5aed" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sampling from equal superposition</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>equal_superposition <span class="op">=</span> [<span class="fl">0.707</span>, <span class="fl">0.707</span>]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>mes <span class="op">=</span> m(equal_superposition) <span class="co"># Transforms [0.707, 0.707] -&gt; [0.5, 0.5] (A coin flip. i.e. Bernoulli distribution))</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="0744e818" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mes <span class="op">=</span> mes <span class="op">/</span> mes.<span class="bu">sum</span>()  <span class="co"># not in original blog but needed as otherwises numers dont add to 1 because of rounding</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>assert_almost_equal(mes, np.array([<span class="fl">0.5</span>,<span class="fl">0.5</span>]))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> samp(mes) <span class="kw">in</span> <span class="st">'01'</span> <span class="co"># 0 or 1 with equal probability</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="8ccb16c9" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sampling from complex superposition</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>complex_superposition <span class="op">=</span> [<span class="fl">0.5</span><span class="op">+</span><span class="ot">0.5j</span>, <span class="fl">0.5</span><span class="op">-</span><span class="ot">0.5j</span>]</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>mcs <span class="op">=</span> m(complex_superposition) <span class="co"># Transforms [0.5+0.5j, 0.5-0.5j] -&gt; [0.5, 0.5] (A coin flip. i.e. Bernoulli distribution)</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>assert_almost_equal(mcs, np.array([<span class="fl">0.5</span>,<span class="fl">0.5</span>]))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="80abe0e7" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> samp(mcs) <span class="kw">in</span> <span class="st">'01'</span>  <span class="co"># Result is 0 or 1 with equal probability</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We can now build a full quantum circuit using <a href="https://AnswerDotAI.github.io/fasttransform/transform.html#pipeline"><code>Pipeline</code></a>. Note that a quantum pipeline is only reversible if it does not include measurement or sampling:</p>
<div id="e0d51571" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>qc <span class="op">=</span> Pipeline([X(), H(), I(), M(), Samp()])</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># X transforms [1, 0] -&gt; [0, 1]</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># H transforms [0, 1] -&gt; [0.707+0j, -0.707+0j]</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># I transforms [0.707+0j, -0.707+0j] -&gt; [0.707+0j, -0.707+0j]</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># M transforms [0.707+0j, -0.707+0j] -&gt; [0.5, 0.5]</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Samp samples from random distribution [0.5, 0.5]</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> qc(zero_state) <span class="kw">in</span> <span class="st">'01'</span> <span class="co"># 0 or 1 with equal probability</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="multi-qubit" class="level3">
<h3 class="anchored" data-anchor-id="multi-qubit">Multi Qubit</h3>
<p>Even though we only discussed single qubit cases we can the potential of <a href="https://AnswerDotAI.github.io/fasttransform/transform.html#transform"><code>Transform</code></a> for quantum. It gets even more powerful if we start working with multiple qubits. The representation of a quantum state on a classical computer grows exponentially with each qubit, because each qubit can be <a href="https://en.wikipedia.org/wiki/Quantum_entanglement">entangled</a> with others. We therefore need a matrix of <span class="math inline">\(2^n\)</span> x <span class="math inline">\(2^n\)</span> to represent a transformation of <span class="math inline">\(n\)</span> qubits. The statevector for <span class="math inline">\(n\)</span> qubits contains <span class="math inline">\(2^n\)</span> complex numbers. Single qubit gates can be combined through the <a href="https://www.math3ma.com/blog/the-tensor-product-demystified">Tensor (Kronecker) product</a>, which we handle in <code>Concat</code>:</p>
<div id="6ce50ee5" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Concat(Transform):</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Combine single qubit gates into a multi-qubit gate"</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, gates): <span class="va">self</span>.gates <span class="op">=</span> gates</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Concatenate 2 or more gates</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> encodes(<span class="va">self</span>, x): <span class="cf">return</span> x <span class="op">@</span> np.kron(<span class="op">*</span>[g.gate <span class="cf">for</span> g <span class="kw">in</span> <span class="va">self</span>.gates])</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reverse propagation for all gates</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> decodes(<span class="va">self</span>, x):</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> g <span class="kw">in</span> <span class="bu">reversed</span>(<span class="va">self</span>.gates): x <span class="op">=</span> x <span class="op">@</span> np.kron(g.gate.conj().T, np.eye(<span class="bu">len</span>(x) <span class="op">//</span> g.gate.shape[<span class="dv">0</span>]))</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>By concatenating single qubit gates we can construct multi-qubit circuits, while keeping the code extremely simple. However, some gates are fundamentally multi-qubit and cannot be constructed from single qubits. One example is the <a href="https://en.wikipedia.org/wiki/Controlled_NOT_gate">Controlled NOT (CNOT) gate</a>, which flips the 2nd qubit from <span class="math inline">\(|0\rangle\)</span> to <span class="math inline">\(|1\rangle\)</span> based on the value of the 1st qubit. When we combine Hadamard on the 1st qubit and a CNOT gate we get the well known <a href="https://en.wikipedia.org/wiki/Bell_state">Bell state</a>. This is a classic example of fully entangling qubits where we obtain <span class="math inline">\(00\)</span> or <span class="math inline">\(11\)</span> with equal probability.</p>
<div id="54f17853" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CNOT(_Q):</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Controlled NOT gate"</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>): <span class="va">self</span>.gate <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                                              [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>], </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                                              [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>], </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                                              [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                     </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>two_qubit_zero_state <span class="op">=</span> np.array([<span class="dv">1</span><span class="op">+</span><span class="ot">0j</span>, <span class="dv">0</span><span class="op">+</span><span class="ot">0j</span>, <span class="dv">0</span><span class="op">+</span><span class="ot">0j</span>, <span class="dv">0</span><span class="op">+</span><span class="ot">0j</span>]) <span class="co"># |00&gt;</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>qc <span class="op">=</span> Pipeline([Concat([H(), I()]), CNOT(), M(), Samp()])</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Concat([H(), I()]) transforms [1, 0, 0, 0] -&gt; [0.707, 0, 0.707, 0]</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co"># CNOT() transforms [0.707, 0, 0.707, 0] -&gt; [0.707, 0, 0, 0.707]</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co"># M() transforms [0.707, 0, 0, 0.707] -&gt; [0.5, 0, 0, 0.5]</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Samp() samples from [0.5, 0, 0, 0.5] (50% chance at 00 and 50% chance at 3, which is 11 in binary)</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> qc(two_qubit_zero_state) <span class="kw">in</span> (<span class="st">'00'</span>,<span class="st">'11'</span>) <span class="co"># 00 or 11 with equal probability</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>These techniques can be used to simulate and analyze more complicated multi-qubit circuits. The nice thing about building quantum circuits like this is that we can analyze every step and get a good understanding of what is happening. It also allows us to precisely explore techniques like&nbsp;<a href="https://en.wikipedia.org/wiki/Quantum_error_correction">quantum error correction</a>. However, for large scale quantum circuits the matrices are huge and&nbsp;<a href="https://en.wikipedia.org/wiki/Quantum_computing">real quantum computers</a>&nbsp;are needed to do the computation. Real quantum computers directly leverage properties of quantum mechanics like entanglement, superposition and interference. These are things that a classical computer can simulate, but cannot natively perform like a real quantum computer. Exploiting quantum properties can result in&nbsp;<a href="https://en.wikipedia.org/wiki/Shor's_algorithm">potentially exponential speedups</a>. For more information on where quantum computers excel check out&nbsp;<a href="https://arxiv.org/abs/1712.05380">Ronald de Wolf’s great paper on “The Potential Impact of Quantum Computers on Society (2017)</a>. This paper has stood the test of time even though new breakthroughs have been achieved.m</p>
</section>
</section>
<section id="closing" class="level2">
<h2 class="anchored" data-anchor-id="closing">Closing</h2>
<p>If you made it all the way to the end, congratulations! I salute you! 🫡 Having an understanding of both advanced Python and quantum computing is a rare skillset. If you are interested in this intersection you might be interested in exploring&nbsp;<a href="https://en.wikipedia.org/wiki/Quantum_machine_learning">Quantum Machine Learning</a>. This field combines the optimization we often see in data science and machine learning with quantum computing. If this piques your interest, one of the best textbooks around is&nbsp;<a href="https://www.amazon.com/Machine-Learning-with-Quantum-Computers-_Quantum-Science-and-Technology_/dp/3030830977?crid=19KO4XCS8WOP8&amp;dib=eyJ2IjoiMSJ9.dNxHwOOX1eQ--tz1drbE8Q5FSOExFYW2vGdIzGTQPD1F1JdSLXDUmGz1gHgNpNrZqLfVexuwQnMc9n8vbR6sNfcs0ijwVKQdLeinveYC5VvKXkCidBuUYhL7U-ftyItGwdtN01Xrz5pC23LQWBhguzaYYMqQ6rSRNHdd8A5h8b-Ly-EWMBOffxQ78eOy6Xs24CERAcdYF9k-UTxOR9fvOZ4mq-_rHleRj9waom7vcRM.ZGWt483eALBI0Qe-jOtxRV0E1C5-SMyDTOhz_QBiZfA&amp;dib_tag=se&amp;keywords=machine+learning+quantum+computers&amp;qid=1732988249&amp;s=books&amp;sprefix=machine+learning+quantum+computer,stripbooks-intl-ship,194&amp;sr=1-1&amp;linkCode=sl1&amp;tag=carloai-20&amp;linkId=ca70ef7f87b0a468dada46c96681d181&amp;language=en_US&amp;ref_=as_li_ss_tl">“Machine Learning with Quantum Computers by Maria Schuld and Francesco Petruccione”</a>.</p>
</section>
<section id="learning-resources" class="level2">
<h2 class="anchored" data-anchor-id="learning-resources">Learning resources</h2>
<p>If you are interested in learning more about quantum, I recommend the following resources:</p>
<section id="online-resources" class="level3">
<h3 class="anchored" data-anchor-id="online-resources">Online Resources<a href="https://carlo.ai/posts/fastcore-quantum#online-resources"></a></h3>
<ul>
<li><a href="https://quantum.country/">Quantum Country - Quantum Education Essays</a></li>
<li><a href="https://learning.quantum.ibm.com/">IBM Quantum Learning Platform</a></li>
<li><a href="https://pennylane.ai/qml">PennyLane Quantum Learning Platform</a></li>
<li><a href="https://github.com/CarloLepelaars/q4p">q4p - Quantum Computing for (Python) Programmers (by Carlo Lepelaars)</a></li>
<li><a href="https://arxiv.org/abs/1712.05380">Paper: The Potential Impact of Quantum Computers on Society (2017) by Ronald de Wolf</a></li>
</ul>
</section>
<section id="books" class="level3">
<h3 class="anchored" data-anchor-id="books">Books<a href="https://carlo.ai/posts/fastcore-quantum#books"></a></h3>
<ul>
<li><a href="https://www.amazon.com/Quantum-Computation-Information-10th-Anniversary/dp/1107002176?crid=VJB5339SIYMB&amp;dib=eyJ2IjoiMSJ9.eSzRaEDPfZNRNJrJx5nhCTp0oQkLWZkujqGOiuevj_sHJbKkL1Gzm-lj8Yg2C3VA11v61b8iZ-lMx5ju_Os5gYarrMvkrmlT5axEqzNql0rF7vdjvVx1wdd4zI7PnuATJf-wu3J6ifpngHnkYPoPII5TV6ywBOK4K34NY0JAHOkhAfyndoZWV3oxb3asowdT77R7mV6CA0CQUD6Vv2zmMFjeeGxBJO4Sexl8HlJNLRQ.fjinpRoMwoKMQ9jlWLL8j1bgA5KWKM-F8lPFzA-5hvo&amp;dib_tag=se&amp;keywords=quantum+computation+and+information&amp;qid=1732985753&amp;sprefix=quantum+computation+and+information,aps,213&amp;sr=8-1&amp;linkCode=sl1&amp;tag=carloai-20&amp;linkId=0a6f532c12be8d87a7717d00f3c91991&amp;language=en_US&amp;ref_=as_li_ss_tl">Quantum Computation and Quantum Information (Nielsen &amp; Chuang)</a></li>
<li><a href="https://www.amazon.com/Machine-Learning-with-Quantum-Computers-_Quantum-Science-and-Technology_/dp/3030830977?crid=19KO4XCS8WOP8&amp;dib=eyJ2IjoiMSJ9.dNxHwOOX1eQ--tz1drbE8Q5FSOExFYW2vGdIzGTQPD1F1JdSLXDUmGz1gHgNpNrZqLfVexuwQnMc9n8vbR6sNfcs0ijwVKQdLeinveYC5VvKXkCidBuUYhL7U-ftyItGwdtN01Xrz5pC23LQWBhguzaYYMqQ6rSRNHdd8A5h8b-Ly-EWMBOffxQ78eOy6Xs24CERAcdYF9k-UTxOR9fvOZ4mq-_rHleRj9waom7vcRM.ZGWt483eALBI0Qe-jOtxRV0E1C5-SMyDTOhz_QBiZfA&amp;dib_tag=se&amp;keywords=machine+learning+quantum+computers&amp;qid=1732988249&amp;s=books&amp;sprefix=machine+learning+quantum+computer,stripbooks-intl-ship,194&amp;sr=1-1&amp;linkCode=sl1&amp;tag=carloai-20&amp;linkId=ca70ef7f87b0a468dada46c96681d181&amp;language=en_US&amp;ref_=as_li_ss_tl">Machine Learning with Quantum Computers (Schuld &amp; Petruccione)</a></li>
<li><a href="https://www.amazon.com/Quantum-Mechanics-Theoretical-Leonard-Susskind/dp/0465062903?_encoding=UTF8&amp;dib_tag=se&amp;dib=eyJ2IjoiMSJ9.bQHxFT9WpIkYRkeCumwpdFVbCjwd5MEHWzWJBHklnGv2UtBa5W-NMv4XeVzQxQBDAskRXb-pN1xeDbczsDL199x-RfGYfKBIXxM2v-2MY25Bk6ZANGLEcIWY2oYafqLc.YEqLRNNMX_gWfLDcAs3fgkEw-13sRkvz5yjdff_tDLI&amp;qid=1732988786&amp;sr=1-3&amp;linkCode=sl1&amp;tag=carloai-20&amp;linkId=109f846df78407b69dccf53cefbf8427&amp;language=en_US&amp;ref_=as_li_ss_tl">Quantum Mechanics: The Theoretical Minimum (Susskind)</a></li>
<li><a href="https://www.amazon.com/Modern-Quantum-Mechanics-J-Sakurai/dp/1108473229?_encoding=UTF8&amp;dib_tag=se&amp;dib=eyJ2IjoiMSJ9.9aiac9T0bD5vFns_B8FoL4VsZn01tfjZm7mj2xOAZQ1W2pM7wyq6nfygNTzWezDFlKiPhAmdLbfyqqOEiZcwK3DZmhx27oLxfQ8Xhruwy7mTk0CoCb1JbZgORWCyRQBJA9AoGY5yB3Da8DtnydBoz-ywC-eDJ29NqklfQS1DIoiJv6b39vKb-GoOMKmFyy8A6iR20tM8KTQwGTkKFYsLu-ZW4twj99IYD0uJPNRbVgM.TLySH0uJr2O7SoAxzEP_SdWdhE44gnkv5BcFdk7cU74&amp;qid=1732995963&amp;sr=1-1&amp;linkCode=sl1&amp;tag=carloai-20&amp;linkId=8aaf375bbfc7b9f162774e1693243980&amp;language=en_US&amp;ref_=as_li_ss_tl">Modern Quantum Mechanics (Sakurai)</a></li>
</ul>
</section>
<section id="youtube" class="level3">
<h3 class="anchored" data-anchor-id="youtube">YouTube<a href="https://carlo.ai/posts/fastcore-quantum#youtube"></a></h3>
<ul>
<li><a href="https://www.youtube.com/@ArturEkert/playlists">Playlist - Introduction to Quantum information Science (Artur Ekert)</a></li>
<li><a href="https://www.youtube.com/watch?v=QtWCmO_KIlg&amp;list=PLmRxgFnCIhaMgvot-Xuym_hn69lmzIokg">Playlist - Quantum Machine Learning (Peter Wittek)</a></li>
<li><a href="https://www.youtube.com/watch?v=Pz829XZIxXg&amp;list=PLOFEBzvs-VvoQP-EVyd5Di3UrPPc2YKIc&amp;index=1">Playlist - Quantum Paradoxes (Maria Violaris)</a></li>
<li><a href="https://www.youtube.com/watch?v=6qD9XElTpCE&amp;list=PLOFEBzvs-VvpNNq221OCZzCZjHadM2NHR&amp;index=1">Playlist - The History of Quantum Computing (Interviews)</a></li>
<li><a href="https://www.youtube.com/watch?v=3nvbBEzfmE8&amp;list=PL8ER5-vAoiHAWm1UcZsiauUGPlJChgNXC">Playlist - Maths of Quantum Mechanics</a></li>
<li><a href="https://www.youtube.com/@LookingGlassUniverse">Channel - Looking Glass Universe</a></li>
<li><a href="https://www.youtube.com/watch?v=-UlxHPIEVqA">Video - The Map of Quantum Computing</a></li>
<li><a href="https://www.youtube.com/watch?v=ZBaXPY_0TNI">Video - Logic Gates Rotate Qubits (Josh’s Channel)</a></li>
<li><a href="https://www.youtube.com/watch?v=nxIGNbcVKtA">Video - How Quantum Entanglement Works</a></li>
<li><a href="https://www.youtube.com/watch?v=mqofuYCz9gs">Video - Interpretations of Quantum Mechanics</a></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/AnswerDotAI\.github\.io\/fasttransform");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/AnswerDotAI/fasttransform/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>